const highlight = document.querySelector('.highlight');
const platforms = document.querySelectorAll('.platform');
const downloadLink = document.querySelector('.download-btn a');

const files = {
    iOS: "file/auver_track_app_ios.ipa",
    Mac: "file/auver_track_app_mac.dmg",
    Windows: "file/auver_track_app_windows.exe",
    Web: "https://example.com"
};

function moveHighlight(target) {
    const rect = target.getBoundingClientRect();
    const parentRect = target.parentElement.getBoundingClientRect();
    highlight.style.width = `${rect.width}px`;
    highlight.style.height = `${rect.height}px`;
    highlight.style.transform = `translate(${rect.left - parentRect.left}px, ${rect.top - parentRect.top}px)`;
}

platforms.forEach(platform => {
    platform.addEventListener('click', () => {
        document.querySelector('.platform.active')?.classList.remove('active');
        platform.classList.add('active');
        moveHighlight(platform);

        const key = platform.dataset.platform;
        const filePath = files[key];

        downloadLink.href = filePath;

        if (key === "Web") {
            downloadLink.removeAttribute("download");
        } else {
            downloadLink.download = filePath.split("/").pop();
        }
    });
});

window.addEventListener('load', () => {
    moveHighlight(document.querySelector('.platform.active'));
});
